# ===============================
# Cartographer MCU (Upstream)
# ===============================
[mcu cartographer]
serial: /dev/serial/by-id/usb-Cartographer_614e_320016000343565633393720-if00
restart_method: command    # per upstream docs

# =======================================
# Cartographer Probe Configuration (Touch)
# =======================================
[cartographer]
mcu: cartographer
# verbose: true # verbose logging (optional, good while dialing in)
# Probe offsets relative to nozzle
x_offset: -18.665
y_offset: -4.3

# ============================
# Cartographer MCU Temperature
# ============================
[temperature_sensor cartographer_mcu]
sensor_type: temperature_mcu
sensor_mcu: cartographer
min_temp: 5
max_temp: 105

[cartographer scan]
mesh_runs: 2
#mesh_path: snake # The path to use when calibrating a scan mesh - either 'snake', 'alternating_snake', 'spiral' or 'random'. The default is snake.

[cartographer touch]
samples: 5 ## Numnber of touch sample
max_samples: 10 ## The maximum number of samples to do before giving up. The default is samples * 2.
UNSAFE_max_touch_temperature: 150 ## The maximum allowed nozzle temperature to use when touching the plate. This is set to 150C to avoid damaging your plate. Change this AT YOUR OWN RISK. The default is 150C.

# [cartographer coil]
#name: cartographer_coil
#   The name of the coil temperature sensor.
#   The default is 'cartographer_coil'.
#min_temp: 0
#   The minimum temperature of the coil, below this will trigger a warning.
#   The default is 0.
#max_temp: 105
#   The maximum temperature of the coil, above this will trigger a warning.
#   The default is 105.

[z_tilt]
# XY positions of the Z screws in NOZZLE coordinate system
z_positions:
    150, 280    # stepper_z   - rear center
    280, 40     # stepper_z1  - front right
    40, 40      # stepper_z2  - front left

# Probe points (safe locations inside your mesh window: 20,20 → 280,270)
# These DO NOT get probe offset applied; Klipper handles that automatically.
points:
    260, 40     # near front-right
    40, 40      # near front-left
    150, 260    # rear-center

speed: 40
horizontal_move_z: 5
retries: 3
retry_tolerance: 0.05    # Later, after it's stable, reduce toward 0.005

# ====================
# Bed Mesh (Cartographer)
# Link for more configs: https://docs.cartographer3d.com/cartographer-probe/features/reference/reference
# ====================
[bed_mesh]
speed: 300
horizontal_move_z: 5
# Your current mesh window – safe with your offsets
# mesh_min: 10,10
mesh_min: 20,20
# mesh_max: 287,287
mesh_max: 280,270
probe_count: 31,31
algorithm: bicubic
bicubic_tension: 0.1
fade_start: 0.5 # full correction from Z=0 to 0.5 mm
fade_end: 30 # gradually less up to Z=30 mm. No mesh above 30mm
# Bed center for reference
zero_reference_position: 150,150
# zero_reference_position: 153.25,150.5 # this is default SimpleAF Klipper Bed Reference. see bottom of homing_override.cfg

# ===========================
# Manual Bed Screws Adjustment
# ===========================
# [screws_tilt_adjust]
# screw1: 25,15
# screw1_name: Front Left
# screw2: 287,15
# screw2_name: Front Right
# screw3: 287,287
# screw3_name: Rear Right
# screw4: 25,287
# screw4_name: Rear Left
# speed: 50
# horizontal_move_z: 5
# screw_thread: CW-M4
[screws_tilt_adjust]
screw1: 25,20      # Front Left
screw1_name: Front Left
screw2: 280,20     # Front Right
screw2_name: Front Right
screw3: 280,270    # Rear Right
screw3_name: Rear Right
screw4: 25,270     # Rear Left
screw4_name: Rear Left
speed: 50
horizontal_move_z: 5
screw_thread: CW-M4


# =============================
# Gantry Axis Twist Compensation
# =============================
[axis_twist_compensation]
speed: 50
horizontal_move_z: 5

# safe values (inside mesh_min/max)
calibrate_start_x: 40
calibrate_end_x: 260
calibrate_y: 150

