# ============================
# Cartographer - General
# ============================

[gcode_macro CARTO_TOUCH_PROBE]
description: Cartographer – Touch Probe
gcode:
    CARTOGRAPHER_TOUCH_PROBE

[gcode_macro CARTO_TOUCH_HOME]
description: Cartographer – Touch Home
gcode:
    CARTOGRAPHER_TOUCH_HOME

[gcode_macro CARTO_SCAN_MODEL]
description: Cartographer – Scan Model
gcode:
    CARTOGRAPHER_SCAN_MODEL LOAD={params.LOAD|default("default")} REMOVE={params.REMOVE|default("")}

[gcode_macro CARTO_TOUCH_MODEL]
description: Cartographer – Touch Model
gcode:
    CARTOGRAPHER_TOUCH_MODEL LOAD={params.LOAD|default("default")} REMOVE={params.REMOVE|default("")}


# ============================
# Cartographer - Calibration
# ============================

[gcode_macro CARTO_SCAN_CALIBRATE]
description: Cartographer – Scan Calibrate
gcode:
    CARTOGRAPHER_SCAN_CALIBRATE MODEL={params.MODEL|default("default")} METHOD={params.METHOD|default("manual")}

[gcode_macro CARTO_ESTIMATE_BACKLASH]
description: Cartographer – Backlash Estimation
gcode:
    CARTOGRAPHER_ESTIMATE_BACKLASH ITERATIONS={params.ITERATIONS|default(10)} DELTA={params.DELTA|default(0.2)} { "CALIBRATE=1" if params.CALIBRATE|default(0)|int == 1 else "" }

[gcode_macro CARTO_TOUCH_CALIBRATE]
description: Cartographer – Touch Calibrate
gcode:
    CARTOGRAPHER_TOUCH_CALIBRATE MODEL={params.MODEL|default("default")} SPEED={params.SPEED|default(2)} START={params.START|default(500)} MAX={params.MAX|default(3000)} STRATEGY={params.STRATEGY|default("default")}

[gcode_macro CARTO_AXIS_TWIST]
description: Cartographer – Axis Twist Compensation
gcode:
    CARTOGRAPHER_AXIS_TWIST_COMPENSATION AXIS={params.AXIS} SAMPLE_COUNT={params.SAMPLE_COUNT|default(5)} START={params.START|default("")} END={params.END|default("")} LINE={params.LINE|default("")}

[gcode_macro CARTO_TEMP_CALIBRATE]
description: Cartographer – Temperature Calibration
gcode:
    CARTOGRAPHER_TEMPERATURE_CALIBRATE BED_TEMP={params.BED_TEMP|default(90)} MIN_TEMP={params.MIN_TEMP|default(40)} MAX_TEMP={params.MAX_TEMP|default(70)} Z_SPEED={params.Z_SPEED|default(5)}


# ============================
# Cartographer - Troubleshooting
# ============================

[gcode_macro CARTO_SCAN_ACCURACY]
description: Cartographer – Scan Accuracy Test
gcode:
    CARTOGRAPHER_SCAN_ACCURACY SAMPLES={params.SAMPLES|default(100)} READINGS={params.READINGS|default(20)}

[gcode_macro CARTO_STREAM]
description: Cartographer – Data Stream
gcode:
    CARTOGRAPHER_STREAM ACTION={params.ACTION|default("status")} FILE={params.FILE|default("~/stream.csv")}

[gcode_macro CARTO_TOUCH_ACCURACY]
description: Cartographer – Touch Accuracy Test
gcode:
    CARTOGRAPHER_TOUCH_ACCURACY SAMPLES={params.SAMPLES|default(5)} LIFT_SPEED={params.LIFT_SPEED|default(5)} SAMPLE_RETRACT_DIST={params.SAMPLE_RETRACT_DIST|default(2)}
